<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLS Ultra HD Tree Demo - Maximum Vertex Density</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
        }
        
        #canvas-container {
            width: 100vw;
            height: 100vh;
        }
        
        #info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.85);
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00ff00;
            max-width: 400px;
            font-size: 12px;
            line-height: 1.6;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }
        
        #info-panel h2 {
            color: #00ffff;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        #info-panel h3 {
            color: #ffff00;
            margin-top: 15px;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .stat {
            padding: 5px 0;
            border-bottom: 1px solid #333;
        }
        
        .stat-label {
            color: #888;
            display: inline-block;
            width: 140px;
        }
        
        .stat-value {
            color: #00ff00;
            font-weight: bold;
        }
        
        .controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.85);
            color: #00ff00;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #00ff00;
        }
        
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #00ffff;
            transform: scale(1.05);
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        select {
            background: #000;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 8px;
            margin: 5px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    
    <div id="info-panel">
        <h2>üå≥ VLS ULTRA HD TREE SYSTEM</h2>
        <div class="stat">
            <span class="stat-label">Current Tree:</span>
            <span class="stat-value" id="tree-type">Oak</span>
        </div>
        <div class="stat">
            <span class="stat-label">Detail Level:</span>
            <span class="stat-value" id="detail-level">Ultra</span>
        </div>
        
        <h3>üìä Vertex Statistics</h3>
        <div class="stat">
            <span class="stat-label">Total Vertices:</span>
            <span class="stat-value" id="total-vertices">0</span>
        </div>
        <div class="stat">
            <span class="stat-label">Unique Vertices:</span>
            <span class="stat-value" id="unique-vertices">0</span>
        </div>
        <div class="stat">
            <span class="stat-label">Total Triangles:</span>
            <span class="stat-value" id="total-triangles">0</span>
        </div>
        <div class="stat">
            <span class="stat-label">Vertex Reuse:</span>
            <span class="stat-value" id="vertex-reuse">0%</span>
        </div>
        
        <h3>‚ö° Performance</h3>
        <div class="stat">
            <span class="stat-label">FPS:</span>
            <span class="stat-value" id="fps">60</span>
        </div>
        <div class="stat">
            <span class="stat-label">Render Time:</span>
            <span class="stat-value" id="render-time">0ms</span>
        </div>
    </div>
    
    <div class="controls">
        <div>
            <label>Tree Type:</label>
            <select id="tree-select">
                <option value="oak">Oak</option>
                <option value="pine">Pine</option>
                <option value="willow">Willow</option>
                <option value="dead">Dead</option>
            </select>
        </div>
        <div>
            <label>Detail Level:</label>
            <select id="detail-select">
                <option value="high">High</option>
                <option value="ultra" selected>Ultra</option>
                <option value="extreme">Extreme ‚ö†Ô∏è</option>
            </select>
        </div>
        <div>
            <button id="generate-btn">Generate Tree</button>
            <button id="rotate-btn">Toggle Rotation</button>
            <button id="wireframe-btn">Toggle Wireframe</button>
        </div>
    </div>

    <script src="https://unpkg.com/three@0.152.0/build/three.min.js"></script>
    <script src="object_generator/vls_parser.js"></script>
    <script src="object_generator/vls_advanced_vertex_mapper.js"></script>
    <script src="world_generation/vls_ultra_hd_tree_generator.js"></script>
    
    <script>
        // Three.js setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87CEEB);
        scene.fog = new THREE.Fog(0x87CEEB, 10, 50);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(5, 3, 5);
        camera.lookAt(0, 2, 0);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        
        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        
        const sunLight = new THREE.DirectionalLight(0xffffff, 0.8);
        sunLight.position.set(10, 20, 10);
        sunLight.castShadow = true;
        sunLight.shadow.camera.left = -10;
        sunLight.shadow.camera.right = 10;
        sunLight.shadow.camera.top = 10;
        sunLight.shadow.camera.bottom = -10;
        sunLight.shadow.mapSize.width = 2048;
        sunLight.shadow.mapSize.height = 2048;
        scene.add(sunLight);
        
        // Ground
        const groundGeometry = new THREE.PlaneGeometry(50, 50);
        const groundMaterial = new THREE.MeshStandardMaterial({ color: 0x228B22, roughness: 0.9 });
        const ground = new THREE.Mesh(groundGeometry, groundMaterial);
        ground.rotation.x = -Math.PI / 2;
        ground.receiveShadow = true;
        scene.add(ground);
        
        // Grid helper
        const gridHelper = new THREE.GridHelper(50, 50, 0x444444, 0x222222);
        scene.add(gridHelper);
        
        // Tree generator
        const vlsParser = new VLSParser();
        const treeGenerator = new VLSUltraHDTreeGenerator(vlsParser);
        
        let currentTree = null;
        let rotating = true;
        let lastTime = performance.now();
        let frameCount = 0;
        let fps = 60;
        
        // Generate initial tree
        generateTree();
        
        // Controls
        document.getElementById('generate-btn').addEventListener('click', generateTree);
        document.getElementById('tree-select').addEventListener('change', generateTree);
        document.getElementById('detail-select').addEventListener('change', generateTree);
        document.getElementById('rotate-btn').addEventListener('click', () => {
            rotating = !rotating;
        });
        document.getElementById('wireframe-btn').addEventListener('click', toggleWireframe);
        
        function generateTree() {
            const startTime = performance.now();
            
            // Remove old tree
            if (currentTree) {
                scene.remove(currentTree);
            }
            
            // Get settings
            const treeType = document.getElementById('tree-select').value;
            const detailLevel = document.getElementById('detail-select').value;
            
            // Generate new tree
            currentTree = treeGenerator.generateUltraHDTree(treeType, {
                position: { x: 0, y: 0, z: 0 },
                scale: 1.0,
                rotation: 0,
                detailLevel: detailLevel,
                color: 0x8B4513,
                leafColor: getLeafColor(treeType)
            });
            
            scene.add(currentTree);
            
            // Update stats
            const renderTime = performance.now() - startTime;
            updateStats(currentTree.userData, renderTime);
            
            console.log('Tree generated in', renderTime.toFixed(2), 'ms');
        }
        
        function getLeafColor(type) {
            const colors = {
                oak: 0x228B22,
                pine: 0x0f5f3a,
                willow: 0x90EE90,
                dead: 0x8B4513
            };
            return colors[type] || 0x228B22;
        }
        
        function updateStats(userData, renderTime) {
            document.getElementById('tree-type').textContent = userData.type.charAt(0).toUpperCase() + userData.type.slice(1);
            document.getElementById('detail-level').textContent = userData.detailLevel.charAt(0).toUpperCase() + userData.detailLevel.slice(1);
            document.getElementById('total-vertices').textContent = userData.vertexCount.toLocaleString();
            document.getElementById('unique-vertices').textContent = userData.vertexCount.toLocaleString();
            document.getElementById('total-triangles').textContent = userData.triangleCount.toLocaleString();
            document.getElementById('vertex-reuse').textContent = userData.vertexReuse;
            document.getElementById('render-time').textContent = renderTime.toFixed(2) + 'ms';
        }
        
        function toggleWireframe() {
            if (currentTree) {
                currentTree.traverse((child) => {
                    if (child.isMesh) {
                        child.material.wireframe = !child.material.wireframe;
                    }
                });
            }
        }
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            // Rotate tree
            if (rotating && currentTree) {
                currentTree.rotation.y += 0.005;
            }
            
            // Calculate FPS
            frameCount++;
            const currentTime = performance.now();
            if (currentTime >= lastTime + 1000) {
                fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
                document.getElementById('fps').textContent = fps;
                frameCount = 0;
                lastTime = currentTime;
            }
            
            renderer.render(scene, camera);
        }
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Start animation
        animate();
        
        console.log('üå≥ VLS Ultra HD Tree Demo Ready');
        console.log('üìä Use controls to test different tree types and detail levels');
    </script>
</body>
</html>
